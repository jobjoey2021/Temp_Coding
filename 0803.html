<!DOCTYPE html>
<!-- saved from url=(0086)https://www.oxxostudio.tw/demo/201706/google-spreadsheet-6-web-write-data-demo-01.html -->
<html lang="zh-TW">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <meta name="author" content="oxxo.studio">
    <meta name="copyright" content="oxxo.studio">
    <title>hair cut record</title>
    <script src="./OXXO.STUDIO_files/jquery-1.9.1.js.下載"></script>
    <style>
        input {
            width: 300px;
            font-size: 15px;
            margin: 2px 0;
            padding: 2px 5px;
        }

        td {
            border: 1px solid #aaa;
            padding: 2px 5px;
        }
    </style>
    <!-- success 20210718 hair cut record in html 2 GDS  -->
    <!-- wait 修改參數 -->
</head>

<body>
    <!-- Google App Script：<input id="appUrl"><br>  -->
    Google App Script：<input id="appUrl"
        value="https://script.google.com/macros/s/AKfycbyr0HBBn1cVQyEPVKC7AHKKCYA061ttTiP7O7wmDvlWXcx6Zb0MkZye2MMEWXUZ0qvo/exec"><br>
    <!-- 試算表網址：<input id="sheetsUrl"><br>  -->
    試算表網址：<input id="sheetsUrl"
        value="https://docs.google.com/spreadsheets/d/19NEEn2sr_w-cxpT57dZ1F_jK60BTv_lGiypE9YM7ZKw/edit#gid=0"><br>
    <!-- 工作表名稱：<input id="sheetName"><br>  -->
    工作表名稱：<input id="sheetName" value="hair"><br>

    寫入方式：
    <select id="type">
        <option value="top">從上寫入</option>
        <option value="bottom">寫入在最後一列</option>
    </select>
    <br>
    資料：
    <br>
    項目：<input id="iterm" value="今天剪髮"><br>
    日期：<input id="today" value="8/1"><br>
    備註：<input id="remark" value="備註"><br>
    <!-- <table>
    <tbody>
      <tr>
        <td>今天剪髮</td>
        <td>日期</td>
        <td>備註</td>
      </tr>
    </tbody>
  </table> -->
    <button id="sendBtn">寫入</button>
    <script>
        // ----------------------------------
        // 時間轉字串，轉成yyyy-MM-dd HH:mm:SS格式
        function dateToStr(datetime) {
            var dateTime = new Date(datetime);
            var year = dateTime.getFullYear();
            var month = dateTime.getMonth() + 1;//js從0開始取
            var date = dateTime.getDate();
            var hour = dateTime.getHours();
            var minutes = dateTime.getMinutes();
            var second = dateTime.getSeconds();

            if (month < 10) {
                month = "0" + month;
            }
            if (date < 10) {
                date = "0" + date;
            }
            if (hour < 10) {
                hour = "0" + hour;
            }
            if (minutes < 10) {
                minutes = "0" + minutes;
            }
            if (second < 10) {
                second = "0" + second;
            }

            return year + "-" + month + "-" + date + " " + hour + ":" + minutes + ":" + second;
        }
        console.log(dateToStr(Date()));
        // ------------------------------------

        var appUrl = $('#appUrl'),
            sheetsUrl = $('#sheetsUrl'),
            sheetName = $('#sheetName'),
            iterm = $('#iterm'),
            today = $('#today'),
            remark = $('#remark'),
            type = $('#type'),
            sendBtn = $('#sendBtn'),
            show = $('#show');
        console.log(iterm);
        console.log(sheetName);
        // var data = [['456','456','789']];


        var data = [['今天剪髮code',dateToStr(Date())]];
        // ------------------
        var parameter = {};
        sendBtn.on('click', function () {
            parameter = {
                url: sheetsUrl.val(),
                name: sheetName.val(),
                data: data.toString(),
                row: data.length,
                column: data[0].length,
                insertType: type.val()
            };
            $.get(appUrl.val(), parameter);
        });
    </script>


    <style>
        #info {
            position: fixed;
            z-index: 999;
            bottom: 20px;
            left: 0px;
            background: #222;
            padding: 20px 30px;
            color: #fff;
            box-shadow: rgba(0, 0, 0, .5) 0 0 10px;
            border-radius: 0 5px 5px 0;
        }

        #info a {
            color: #0bf;
            transition: .2s;
        }

        #info a:hover {
            color: #6df;
        }
    </style>
    <!-- <div id="info">相關參考：<a id="infoLink" href="https://www.oxxostudio.tw/articles/201706/google-spreadsheet-6-web-write-data.html" target="_blank">Google 試算表 (6) - 網頁寫入資料 </a></div> -->
    <script>
        var href = location.href;
        var page = href.split("demo/");
        var name = page[1].split("-demo")[0];
        var title = document.querySelector('title').innerHTML;
        document.getElementById('infoLink').setAttribute('href', '/articles/' + name + '.html');
        document.getElementById('infoLink').innerHTML = title.split("demo")[0];
    </script>



</body>

</html>